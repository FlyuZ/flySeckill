<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>个人中心</title>
    <link rel="stylesheet" th:href="@{../../css/bootstrap.min.css}"/>
    <link rel="stylesheet" th:href="@{../../css/seckill.css}"/>
    <link rel="stylesheet" th:href="@{../../css/seckill_item.css}"/>
    <link rel="stylesheet" th:href="@{../../css/public.css}"/>
    <!-- FontAwesome Styles-->
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css">
    <!--<link href="assets/css/font-awesome.css" rel="stylesheet" />-->
    <link href="//cdn.bootcss.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Morris Chart Styles-->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <!-- TABLE STYLES-->
    <style>
        label {
            margin-top: 5px;
        }
    </style>
</head>
<style type="text/css">
    table, th , td  {
        border: 1px solid grey;
        border-collapse: collapse;
        padding: 5px;
    }
    table tr:nth-child(odd) {
        background-color: #f1f1f2;
    }
    table tr:nth-child(even) {
        background-color: #ffffff;
    }
</style>
<body>
<div th:if="${session.session_user} != null">
    <div th:replace="public/header :: information_header"></div>
    <div th:replace="public/guide :: information_guide"></div>
    <div id="order" style="position: absolute;margin-left: 150px;width: 100%;">
        <span >
            <h2>我的订单</h2>
        </span>

        <div>
            <div th:each="item : ${seckillOrders}" style="height: 225px; border-color: antiquewhite;border-width: 1px;margin-left: 20px;border: solid;margin-top: 20px;width: 1100px">
                <div style="height: 200px" th:each="goods : ${goods}" th:if="${item.goodsId} == ${goods.goodsId}">
                    <div >
                    <div style="display: inline-block;height: 180px; width:200px;margin-top: 20px;float: top;margin-left: 10px;position: absolute">
                        <img th:src="${goods.image}" style="height: 150px;width: 150px;"/>
                        <button th:if="${item.state} != '已支付'" class="paybtn btn btn-success" style="margin-top: 11px;margin-left: 50px;" th:id="${item.orderNo}">支付</button>
                    </div>


                    <div style="display: inline-block; margin-left: 200px; width: 800px;margin-top: 0;">
                        <br>
                        <div  style="height:40px "><b>商品:</b><p th:text="${goods.goodsName}"></p> </div>
                        <br>
                        <div style="width: 800px">
                            <br>
                            创建时间：<p th:text="${item.createTime}"></p>
                            <br>
                            支付状态：<p th:text="${item.state}"></p>
                        </div>
                    </div>

                    </div>
                </div>
            </div>
        </div>
    </div>


</div>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script type="text/javascript" th:src="@{../../js/bootstrap.min.js}"></script>
<script>
    $(function () {


        $(".paybtn").click(function () {
           var order_no = $(this).attr("id");
           $.ajax({
              url:"/seckill/pay",
              type:"post",
              data:{"orderNo":order_no},
              dataType:"text",
              success:function (res) {
                  if(res == "success")
                  {
                      alert("支付成功！！！");
                      window.location.reload();
                  }
                  else {
                      alert("支付失败！！！")
                  }

              } ,
               error:function (err) {
                   alert("支付失败！！！")
                   console.log(err)
               }
           });
        });
    });
</script>
</body>
</html>
